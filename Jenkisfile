pipeline {
    agent { label 'master' }
    stages {




        stage('CI') {
            steps {
            withCredentials([usernamePassword(credentialsId: 'docker', passwordVariable: 'docker_pass', usernameVariable: 'docker_username')]) {
               sh """
               docker build  -t hellonode .
		       docker login -u ${docker_username} -p ${docker_pass}
    		   docker push Arwa98/hellonode:latest
               """
                }
            }
        }



        stage('CD') {
            steps {
                 withCredentials([usernamePassword(credentialsId: 'docker', passwordVariable: 'docker_pass', usernameVariable: 'docker_username')]) {
               sh """
		docker login -u ${docker_username} -p ${docker_pass}
		docker run -p 3000:3000 -d hellonode
                """
		
            }
        }





    }
}